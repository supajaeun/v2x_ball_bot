<?xml version="1.0"?>
<robot name="yahboomcar_X3" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- ===== XACRO ARGS ===== -->
  <xacro:arg name="ns"               default="car1"/>
  <xacro:property name="ns" value="$(arg ns)"/>
  <xacro:arg name="left_joint"       default="front_left_joint"/>
  <xacro:arg name="right_joint"      default="front_right_joint"/>
  <xacro:arg name="wheel_separation" default="0.30"/>
  <xacro:arg name="wheel_diameter"   default="0.10"/>
  <xacro:arg name="base_frame"       default="${ns}/base_link"/>
  <xacro:arg name="odom_frame"       default="${ns}/odom"/>
  <xacro:arg name="laser_link_name"  default="${ns}/laser_link"/>

  <!-- 재질 -->
  <material name="Green"><color rgba="0 0.7 0 1"/></material>
  <material name="White"><color rgba="0.7 0.7 0.7 1"/></material>

  <!-- ===== 매크로 ===== -->
  <xacro:macro name="common_link" params="name material path *origin">
    <link name="${ns}/${name}">
      <visual>
        <geometry>
          <mesh filename="package://v2x_ball_bot_description/meshes/${path}/${name}.STL"/>
        </geometry>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <material name="${material}"/>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://v2x_ball_bot_description/meshes/${path}/${name}.STL"/>
        </geometry>
        <origin xyz="0 0 0" rpy="0 0 0"/>
      </collision>
      <xacro:insert_block name="origin"/>
    </link>
  </xacro:macro>

  <xacro:macro name="continuous_joint" params="name parent child xyz rpy axis">
    <joint name="${ns}/${name}" type="continuous">
      <parent link="${ns}/${parent}"/>
      <child  link="${ns}/${child}"/>
      <origin xyz="${xyz}" rpy="${rpy}"/>
      <axis xyz="${axis}"/>
    </joint>
  </xacro:macro>

  <xacro:macro name="fixed_joint" params="name parent child xyz rpy">
    <joint name="${ns}/${name}" type="fixed">
      <parent link="${ns}/${parent}"/>
      <child  link="${ns}/${child}"/>
      <origin xyz="${xyz}" rpy="${rpy}"/>
    </joint>
  </xacro:macro>

  <gazebo>
    <plugin name="skid_steer" filename="libgazebo_ros_skid_steer_drive.so">
      <front_left_joint> ${ns}/front_left_joint  </front_left_joint>
      <rear_left_joint>  ${ns}/back_left_joint   </rear_left_joint>
      <front_right_joint>${ns}/front_right_joint </front_right_joint>
      <rear_right_joint> ${ns}/back_right_joint  </rear_right_joint>
      <wheel_separation>$(arg wheel_separation)</wheel_separation>
      <wheel_diameter>$(arg wheel_diameter)</wheel_diameter>
      <odom_frame>$(arg odom_frame)</odom_frame>
      <base_frame>$(arg base_frame)</base_frame>
      <publish_tf>true</publish_tf>
      <cmd_vel_topic>cmd_vel</cmd_vel_topic>
      <odometry_topic>odom</odometry_topic>
      <update_rate>50</update_rate>
    </plugin>
  </gazebo>

</robot> 